//console.log("load message");
//window.scrollBy(0, 200);

  var field_id_name = "#chat-field";
  var message_id = "<%= @message.id %>";
  var element_for_message_id = ".chat-select-button-" + message_id;
  var first_element_of_message_id = '.chat-select-button-' + message_id + ":first";


  $(field_id_name).append(
    `
    <%= render "messages/message", message: @message unless @message.blank? %>

    `
  );

  setTimeout(
  function()
  {

    $('html, body').animate({
        console.log(first_element_of_message_id);
        scrollTop: $(first_element_of_message_id).offset().top
        //scrollTop: $('.martigny:first').offset().top
    }, 1000);


  }, 1000);



  //$('html, body').animate({
  //  scrollTop: $(".chat-select-button-" + message_id).offset().top
  //}, 2000);

  //document.getElementById("element-id").scrollIntoView();

  //VEGANCHAT

  var ids_of_children = "<%= @message.children.pluck(:id) %>";

  setTimeout(
  function()
  {

    $.each(JSON.parse(ids_of_children), function(index, value){
    	get_button(value, index * 1000);
    });


  }, 1000);

  function get_message(id, timeout) {
    setTimeout(
    function()
    {

      VEGANCHAT.get_message_with_ajax(id);


    }, timeout);
  }

  function get_button(id, timeout) {
    setTimeout(
    function()
    {

      VEGANCHAT.get_button_with_ajax(id);


    }, timeout);
  }

  setTimeout(
  function()
  {
    let target_message_id = "<%= @message.target_message_id %>";
    let load_next_message = "<%= (Message.where(id: @message.target_message_id).present?).to_s %>";

    //console.log(load_next_message);

    if (load_next_message === "true") {

      VEGANCHAT.get_message_with_ajax(target_message_id);

    }

  }, 2000);
