//console.log("load message");
//window.scrollBy(0, 200);

  var field_id_name = "#chat-field";
  var message_id = "<%= @message.id %>";
  var element_message_id = ".message_" + message_id;
  var element_for_message_id = ".chat-select-button-" + message_id;
  var first_element_of_message_id = '.chat-select-button-' + message_id;
  var target_message_id = "<%= @message.target_message_id %>";

  $(field_id_name).append(
    `
    <%= render "messages/message", message: @message unless @message.blank? %>

    `
  );

  VEGANCHAT.animateCSS(element_message_id, 'bounceIn');

  $('html, body').animate({
      scrollTop: $(element_message_id).last().offset().top
  }, 1000);




  //$('html, body').animate({
  //  scrollTop: $(".chat-select-button-" + message_id).offset().top
  //}, 2000);

  //document.getElementById("element-id").scrollIntoView();

  //VEGANCHAT

  var ids_of_children = "<%= @message.children.pluck(:id) %>";

  setTimeout(
  function()
  {

    $.each(JSON.parse(ids_of_children), function(index, value){
    	get_button(value, index * 1000);
    });


  }, 2000);

  function get_message(id, timeout) {
    setTimeout(
    function()
    {

      VEGANCHAT.get_message_with_ajax(id);


    }, timeout);
  }

  function get_button(id, timeout) {
    setTimeout(
    function()
    {

      VEGANCHAT.get_button_with_ajax(id);


    }, timeout);
  }

  setTimeout(
  function()
  {

    var load_next_message = "<%= (Message.where(id: @message.target_message_id).present?).to_s %>";

    if (load_next_message === "true") {

      console.log(target_message_id);

      VEGANCHAT.get_message_with_ajax(target_message_id);

    }

  }, 2000);
